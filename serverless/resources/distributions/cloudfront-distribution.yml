Type: AWS::CloudFront::Distribution
Properties:
  DistributionConfig:
    Enabled: true
    Comment: genAi prototype by serverless-infra
    # SPA Entry Point - wird beim Aufruf der Root-URL geladen
    DefaultRootObject: index.html
    Origins:
      - OriginAccessControlId: EMG08YO2KH1LQ
        DomainName: !GetAtt StaticSite.DomainName
        Id: ${self:service}-${self:provider.stage}

    DefaultCacheBehavior:
      TargetOriginId: ${self:service}-${self:provider.stage}
      ViewerProtocolPolicy: redirect-to-https
      # bzgl. der IDs siehe https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/using-managed-cache-policies.html
      CachePolicyId: 4135ea2d-6df8-44a3-9df3-4b5a84be39ad # Recommended caching policy
      Compress: true
      ForwardedValues:
        QueryString: false
        Cookies:
          Forward: none
      DefaultTTL: 86400
      MinTTL: 0
      MaxTTL: 31536000
    CustomErrorResponses:
      - ErrorCode: 404
        ResponseCode: 200
        ResponsePagePath: /index.html
        ErrorCachingMinTTL: 300
      - ErrorCode: 403
        ResponseCode: 200
        ResponsePagePath: /index.html
        ErrorCachingMinTTL: 300

  Tags:
    - Key: map-migrated
      Value: mig8HJ3AJM0OD
